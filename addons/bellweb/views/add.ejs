<% include includes/header.ejs %>
  <% include includes/layout.ejs %>

    <script type="text/javascript">
      $(document).ready(function() {

        $("[id$='_group']").hide()

        $("[id$='_toggle']").on("change", function(item) {
          $("[id$='" + event.target.id + "_group']").toggle(item.checked)
        })

      });
    </script>

    <h1>Add New Bell</h1>
    <form method="post" class="form-horizontal">
      <div class="form-group form-group-sm">
        <label for="id" class="col-sm-1 control-label">ID for bell</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" name="id" placeholder="period1">
          <p class="help-block">Lowercase, alphanumeric only</p>
        </div>
      </div>

      <div class="form-group form-group-sm">
        <label for="name" class="col-sm-1 control-label">Name</label>
        <div class="col-sm-10">
          <input type="text" class="form-control" name="name" placeholder="Bell for first period">
        </div>
      </div>

      <div class="form-group form-group-sm">
        <label for="description" class="col-sm-1 control-label">Description</label>
        <div class="col-sm-10">
          <textarea name="description" class="form-control" placeholder="This bell rings at the start of period 1"></textarea <p class="help-block">The description should be 1-2 sentences maximum</p>
        </div>
      </div>
      <!-- <div class="form-group form-group-sm">
      <label for="locked" class="col-sm-1 control-label">Locked:</label>
      <div class="col-sm-10">
        <input type="checkbox" class="">
        <p class="help-block">If locked, a job can't be edited from the web UI</p>
      </div>
    </div> -->

      <div class="form-group form-group-sm">
        <label for="time" class="col-sm-1 control-label">Time</label>
        <div class="col-sm-10">
          <input type="text" name="time" class="form-control" placeholder="15 9 * * *">
          <p class="help-block">The time to run, in <a href="https://en.wikipedia.org/wiki/Cron#Configuration_file">cron format</a>. You can generate cron expressions <a href="http://www.cronmaker.com/">here</a></p>
        </div>
      </div>

      <!-- Now on to the actions -->

      <div class="form-group form-group-sm">
        <label class="col-sm-1 control-label">Actions</label>
        <div class="col-sm-10">
          <div class="checkbox">
            <label for="audio_toggle">
              <input type="checkbox" class="" id="audio_toggle" name="audio">Play Audio</label>
          </div>
          <div class="checkbox">
            <label for="external_toggle">
              <input type="checkbox" class="" id="external_toggle" name="external">External Ringer</label>
          </div>
          <div class="checkbox">
            <label for="mail_toggle">
              <input type="checkbox" class="" id="mail_toggle" name="mail">Send Email(s)</label>
          </div>
          <div class="checkbox">
            <label for="schedule_toggle">
              <input type="checkbox" class="" id="schedule_toggle" name="schedule">Switch Schedule</label>
          </div>
          <div class="checkbox">
            <label for="toggle_toggle">
              <input type="checkbox" class="" id="toggle_toggle" name="toggle">Toggle Bell(s)</label>
          </div>
          <p class="help-block">Actions to perform when this bell is triggered</p>
        </div>
      </div>

      <% include mail_trigger.ejs %>

        <div id="mail_change_toggle_group" class="well well-lg">
          <h4>Email on Change</h4>
          <p>This email will fire when a bell is enabled, disabled, edited or deleted</p>
          <div class="form-group form-group-sm">
            <label class="col-sm-1 control-label">Enabled</label>
            <div class="col-sm-10">
              <div class="radio">
                <label for="mail_change_enabled">
                  <input type="radio" name="mail_change_enabled" id="mail_change_enabled" value="true" checked="checked"> True
                </label>
              </div>
              <div class="radio">
                <label for="mail_change_disabled">
                  <input type="radio" name="mail_change_enabled" id="mail_change_disabled" value="false" checked="checked"> False
                </label>
              </div>
            </div>
          </div>

          <div class="form-group form-group-sm">
            <label for="mail_change_to" class="col-sm-1 control-label">To</label>
            <div class="col-sm-10">
              <input type="text" name="mail_change_to" class="form-control" value="test@example.com">
              <p class="help-block">Who to send the email to</p>
            </div>
          </div>

          <div class="form-group form-group-sm">
            <label for="mail_change_subject" class="col-sm-1 control-label">Subject</label>
            <div class="col-sm-10">
              <input type="text" id="mail_change_subject" name="mail_change_subject" class="form-control" value="Sample Email">
              <p class="help-block">Subject of the email</p>
            </div>
          </div>

          <div class="form-group form-group-sm">
                <label for="mail_change_template" class="col-sm-1 control-label">File(s)</label>
                <div class="col-sm-10">
                  <select name="mail_change_template" id="mail_change_template" class="form-control">
                    <% bellboy.modules["bellmail"].ViewFiles().forEach(function(item){ %>
                      <option>
                        <%= item %>
                      </option>
                      <% }) %>
                  </select>
                  <p class="help-block">To add more templates files, upload them to /addons/bellmail/templates</p>
                </div>
              </div>
            </div>

        </div>

        <button type="submit" name="submit" class="btn btn-default">Submit</button>

    </form>
    <% include includes/footer.ejs %>
